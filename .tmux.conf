set -g mouse on

set -g default-command zsh

# Automatically rename windows to the current directory basename
set -g automatic-rename on
set -g automatic-rename-format "#{b:pane_current_path}"

# for vim color scheme
set -g default-terminal "tmux-256color"
set-option -sa terminal-overrides ",xterm-256color:RGB"

# Catppuccin v2 configuration (set BEFORE loading the plugin)
set -g @catppuccin_flavor "mocha"
set -g @catppuccin_window_status_style "basic"

# Window text - use basename of current path for automatic rename effect
set -g @catppuccin_window_text " #{b:pane_current_path}"
set -g @catppuccin_window_current_text " #{b:pane_current_path}"

# Pane border style
set -g @catppuccin_pane_active_border_style "fg=#{@thm_peach}"

# Custom date/time format
set -g @catppuccin_date_time_text " %Y-%m-%d %a %I:%M:%S %p"

# Status bar separators (block style instead of rounded)
set -g @catppuccin_status_left_separator "â–ˆ"
set -g @catppuccin_status_middle_separator ""
set -g @catppuccin_status_right_separator " "
set -g @catppuccin_status_fill "icon"

# Load catppuccin (MUST be loaded before setting status-left/right)
run '~/.tmux/plugins/tmux/catppuccin.tmux'

# Status line configuration (MUST come AFTER catppuccin loads)
set -g status-right-length 100
set -g status-left-length 100
set -g status-left ""
set -g status-right "#{E:@catppuccin_status_session}"
set -ag status-right "#{E:@catppuccin_status_date_time}"

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# tmux-continuum settings
set -g @continuum-restore 'on'

# Use vim keybindings
set-window-option -g mode-keys vi
bind-key -T copy-mode-vi v send -X begin-selection
bind-key -T copy-mode-vi V send -X select-line
bind-key -T copy-mode-vi y send -X copy-pipe-and-cancel 'xclip -in -selection clipboard'

# Add workmux status to default choose-tree format
bind-key w choose-tree -Zw -F "#{?pane_format,#{?pane_marked,#[reverse],}#{pane_current_command}#{?pane_active,*,}#{?pane_marked,M,}#{?#{&&:#{pane_title},#{!=:#{pane_title},#{host_short}}},: \"#{pane_title}\",},#{?window_format,#{?window_marked_flag,#[reverse],}#{window_name}#{window_flags}#{?#{&&:#{==:#{window_panes},1},#{&&:#{pane_title},#{!=:#{pane_title},#{host_short}}}},: \"#{pane_title}\",},#{session_windows} windows#{?session_grouped, (group #{session_group}: #{session_group_list}),}#{?session_attached, (attached),}}} #{@workmux_status}"

# Initialize TMUX plugin manager (keep this line at the very bottom)
run '~/.tmux/plugins/tpm/tpm'
